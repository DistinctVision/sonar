## Однородное пространство

В предыдущей статье мы рассматривали эвклидово пространство. 
Точки в двумерном эвклидовом пространстве обозначаются при помощи двумерных векторов $\begin{pmatrix} x & y \end{pmatrix}^T$. А такое пространство обозначается как $\mathbb{R}^2$. $\begin{pmatrix} x & y \end{pmatrix}^T \in \mathbb{R}^2$.  
Введем понятие однородного пространства. Оно обозначается как $\mathbb{P}^2$. Чтобы перевести вектор из двумерного эвклидового пространства, нужно взять любой ненулевой скаляр, умножить на него вектор и добавить этот скаляр в качестве последней компоненты: $\vec v = \begin{pmatrix} x & y \end{pmatrix}^T \in \mathbb{R}^2 \space \rightarrow \space \vec p = \begin{pmatrix} x \cdot w & y \cdot w & w \end{pmatrix}^T \in \mathbb{P}^2$. Получаем координаты точки в уже в однородных координатах. Таким образом одной точке однородного пространства принадлежит бесконечное множество точек эвклидового пространства. Чтобы перевести однородные координаты точки обратно в эвклидово простраство, нужно соответственно разделить вектор на его последнюю компоненту и удалить ее же из вектора: $\vec p = \begin{pmatrix} x & y & w \end{pmatrix}^T \in \mathbb{P}^2 \space \rightarrow \space \vec v = \begin{pmatrix} \frac{x}{w} & \frac{y}{w} \end{pmatrix}^T \in \mathbb{R}^2$.  
Тут же можно заметить, что умножение однородных координат однородного пространства на скаляр не меняет координат точек в эвклидовом пространстве: $\vec{p_B} = \vec{p_A} \cdot s = \begin{pmatrix} x \cdot s & y \cdot s & w \cdot s \end{pmatrix}^T \in \mathbb{P}^2 \space \rightarrow \space \vec v = \begin{pmatrix} \frac{x \cdot s}{w \cdot s} & \frac{y \cdot s}{w \cdot s} \end{pmatrix}^T = \begin{pmatrix} \frac{x}{w} & \frac{y}{w} \end{pmatrix}^T \in \mathbb{R}^2$.  
Также, если последняя компонента равна 0, то такую точку мы не сможем перевести в эвклидово пространство: $\begin{pmatrix} x & y & 0 \end{pmatrix}^T \in \mathbb{P}^2$ – такая точка называется точкой на бесконечности (point at infinity или ideal point).  
При переводе эвклидовых координат в однородные удобно в качестве скаляра, на который умножается вектор, брать 1: $\vec v = \begin{pmatrix} x & y \end{pmatrix}^T \in \mathbb{R}^2 \space \rightarrow \space \vec p = \begin{pmatrix} x & y & 1 \end{pmatrix}^T \in \mathbb{P}^2$.  
Перевод обратно в таком случае также упрощается: $\vec p = \begin{pmatrix} x & y & 1 \end{pmatrix}^T \in \mathbb{P}^2 \space \rightarrow \space \vec v = \begin{pmatrix} x & y \end{pmatrix}^T \in \mathbb{R}^2$.  
Из уроков школьной геометрии мы помним уравнение линии: $y = k \cdot x + b$, где коэффициенты $k$ и $b$ определяют нашу линию. Но удобнее рассматривать линии в другой форме: $a \cdot x + b \cdot y + c = 0$. Можем вывести соотношение этих коэффициентов: $a = k_{line}, \space b = -1, \space c = b_{line}$. А еще удобнее перевести набор коэффициентов в вектор-строку: $l = \begin{pmatrix} a & b & c \end{pmatrix}$.  
Разобравшись с однородными координатами, мы можем теперь рассмотреть свойства точек и линий в этих координатах:  
* Так как $a \cdot x + b \cdot y + c = 0$, то точка лежит на линии. В однородных координатах может записать это так: $l \cdot \vec v = \begin{pmatrix} a & b & c \end{pmatrix} \cdot \begin{pmatrix} x \\ y \\ 1 \end{pmatrix} = 0$.
* Первые две компоненты линии $l$ ($a$ и $b$) - это вектор-перпендикуляр к этой самой линии в эвклидовых координатах. Можно этот вектор нормализовать, тогда компонента $с$ будет равна расстоянию линии до начала координат. А умножая вектор линии на вектор точки, получим расстояния от линии до точки: $l = \begin{pmatrix} a & b & c \end{pmatrix}, \vec v = \begin{pmatrix} x & y & 1 \end{pmatrix}^T, \space \space distance(l, \vec v) = (\frac{l}{|\begin{pmatrix} a & b \end{pmatrix}^T|}) \cdot \begin{pmatrix} x & y & 1 \end{pmatrix}^T$.
* Вектор линии $l$ из двух точек $\vec{p_A}$ и $\vec{p_B}$ можно получить их векторным произведением: $l = (\vec{p_A} \times \vec{p_B})^T$.
* Координаты точки пересечения $\vec p$ двух линий $l_A$ и $l_B$ можно получить их векторным произведением: $\vec{p} = \vec{{l_A}^T} \times \vec{{l_B}^T}$. Если линии параллельны, то $p_w = 0$ - а значит получим точку на бесконечности и не сможем перевести ее в эвклидово пространство. Также вектор $\vec n = \begin{pmatrix} p_x & p_y \end{pmatrix}^T$ - будет перпендикуляром к исходным линиям.  
* Возьмем две точки на бесконечности $\vec{p_A} = \begin{pmatrix} {p_A}_x & {p_A}_y & 0 \end{pmatrix}^T$, $\vec{p_B} = \begin{pmatrix} {p_B}_x & {p_B}_y & 0 \end{pmatrix}^T$ и найдем линию, пересекающую эти две точки: $l = (\vec{p_A} \times \vec{p_B})^T$. В результате получим линию, первые две компоненты вектора которой равны нулю: $l = (\vec{p_A} \times \vec{p_B})^T = \begin{pmatrix} 0 & 0 & {p_A}_x \cdot {p_B}_y - {p_A}_y \cdot {p_B}_x \end{pmatrix}$. Такую линию мы не сможем отобразить в эвклидовом пространстве. Называется она линией на бесконечности (line at infinity). Она не имеет перпендикуляра и пересекается со всеми точками на бесконечности.